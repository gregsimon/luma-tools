
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/luma.css">
    <script src="js/webmidi.min.js"></script>
    <script src="js/WavAudioEncoder.min.js"></script>
    <script src="js/codecs.mjs"></script>
    <script src="js/jszip.min.js"></script>
    <script src="js/luma.js"></script>
    <title>Luma-1 Tools</title>
  </head>
  <body onload='luma1_init()'>
    
    <div class = 'main_section'>
      Drag a .bin (sample ROM) or wav file into the box. [Spacebar] previews audio.
      
      <div class = 'waveform' 
            ondragover="dragOverHandler(event);"
            ondrop='dropHandler(event);'>
            <canvas id="editor_canvas" width="700px" height="240px"></canvas>
      </div>

      <div id="status">
        &nbsp;
      </div>

      <div style="flex-direction: row;">
        <div>
          <select id='midiOut' onchange='changeMidiOut();'>
              <option value="">No MIDI connection</option>
          </select>
          <select id='binaryFormat' onchange='changeBinFormat();'>
            <option value="ulaw_u8">UInt8 uLaw</option>
            <option value="pcm_u8">UInt8 PCM</option>
        </select>
          Sel Index:<input class='numeric' style="text-align:right" type='text' value="0" id='in_point'/>
          &mdash;<input class='numeric' type='text' value="0" id='out_point'/>
          <input type='button' value="Select All" onclick="resetRange()"/>
          <input type='button' value="Reverse" onclick="reverseSampleBuffer()"/>
          <input type='button' value="Preview" onclick="playAudio()"/>          
        </div>
      </div>

      <br>

      <div style="flex-direction: row;">
        <div>
          <input type='button' value="Read Sample from Device" onclick="requestDeviceSample()"/>
          Which slot: <select id='slotId'>
          </select>
          Which bank:
          <select id='bankId'></select>
          Sample name:<input type='text' value="untitled" id='sample_name'/>
          <input type='button' value="Export WAV..." onclick="exportSample()"/>
          <input type='button' value="Send Sample to Device" onclick='sendEditorSampleToLuma()' />          
        </div>
      </div>


      <div class="waveform_slots">
        <hr>
        <ul>
          <li><canvas id="canvas_slot_0" class="mini_waveform_canvas"></canvas></li>
          <li><canvas id="canvas_slot_1" class="mini_waveform_canvas"></canvas></li>
          <li><canvas id="canvas_slot_2" class="mini_waveform_canvas"></canvas></li>
          <li><canvas id="canvas_slot_3" class="mini_waveform_canvas"></canvas></li>
          <li><canvas id="canvas_slot_4" class="mini_waveform_canvas"></canvas></li>

          <li><canvas id="canvas_slot_5" class="mini_waveform_canvas"></canvas></li>
          <li><canvas id="canvas_slot_6" class="mini_waveform_canvas"></canvas></li>
          <li><canvas id="canvas_slot_7" class="mini_waveform_canvas"></canvas></li>
          <li><canvas id="canvas_slot_8" class="mini_waveform_canvas"></canvas></li>
          <li><canvas id="canvas_slot_9" class="mini_waveform_canvas"></canvas></li>
        </ul>
        <input type='button' value="Read Bank From Device" onclick="readBankfromDevice()"/>
        Which bank: <select id='bankId2'></select>
        Bank name: <input type='text' value='Untitled' id='bank_name'/>
        <input type='button' value="Export Bank..." onclick="exportBankAsZip()"/>
        <input type='button' disabled value="Write Bank To Device" onclick="writeBank()"/>
          
      </div>

      <div style="flex-direction: row;">
        <hr>
        <div>
          Notes:
          <br>Drag a binary file (8-bit PCM or uLaw) or Wav file into editor area above.
          <br>Set "in" endpoint by click/draging on upper half of waveform.
          <br>Set "out" endpoint by click/dragging on lower half of waveform. 
          <br>Press "Spacebar" to playback sample in browser
          <br>Hold "Shift" while dragging endpoints to lock cursor to 1k (1024 samples) 
          <br>Drag waveforms between slots in the staging area, they can also be dragged to and from the editor
          <br>The "STAGING" bank represents the samples currently loaded into the cards, the numbered banks are banks stored on the internal SD card.
        </div>
        <hr>
        <div>
          <a href="mailto:gregsimon@gmail.com">Feedback</a>
          |
          <a href="https://github.com/gregsimon/luma-tools">GitHub</a>
          |
          Deployed on: <span id="deployed_date"></span>
        </div> 
        
      </div>
      
    </div>

  </body>
</html>

